

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Auditd &mdash; Sécurité Linux v1.0 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Mise en place de AppArmor" href="apparmor.html" />
    <link rel="prev" title="Rsyslog" href="rsyslog.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> Sécurité Linux
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Niveau minimal ANSSI</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Procédure d’installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="hardening_PAM.html">Hardening PAM</a></li>
<li class="toctree-l1"><a class="reference internal" href="application_correctifs.html">Applications des correctifs</a></li>
</ul>
<p class="caption"><span class="caption-text">Niveau intermédiaire ANSSI</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="parefeu_local.html">Parefeu local</a></li>
<li class="toctree-l1"><a class="reference internal" href="hardening_openssh.html">Hardening de OpenSSH</a></li>
<li class="toctree-l1"><a class="reference internal" href="confinement_droits_sudo.html">Confinement des droits sudo</a></li>
<li class="toctree-l1"><a class="reference internal" href="hardening_grub.html">Hardening de Grub</a></li>
<li class="toctree-l1"><a class="reference internal" href="desactivation_magickeys.html">Désactivation des Magic keys</a></li>
<li class="toctree-l1"><a class="reference internal" href="rsyslog.html">Rsyslog</a></li>
</ul>
<p class="caption"><span class="caption-text">Niveau renforcé ANSSI</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Auditd</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#classification">Classification</a></li>
<li class="toctree-l2"><a class="reference internal" href="#sources">Sources</a></li>
<li class="toctree-l2"><a class="reference internal" href="#procedures">Procédures</a></li>
<li class="toctree-l2"><a class="reference internal" href="#commentaires">Commentaires</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Niveau élevé ANSSI</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="apparmor.html">Mise en place de AppArmor</a></li>
</ul>
<p class="caption"><span class="caption-text">Audits de sécurité</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="audit_lynis.html">Audit Lynis</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Sécurité Linux</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Auditd</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/src/auditd.md.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="auditd">
<h1>Auditd<a class="headerlink" href="#auditd" title="Permalink to this headline">¶</a></h1>
<div class="section" id="classification">
<h2>Classification<a class="headerlink" href="#classification" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Niveau ANSSI : renforcé</p></li>
<li><p>Audit</p></li>
<li><p>Journalisation</p></li>
<li><p>Moindre privilèges</p></li>
</ul>
</div>
<div class="section" id="sources">
<h2>Sources<a class="headerlink" href="#sources" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://www.ssi.gouv.fr/uploads/2016/01/linux_configuration-fr-v1.2.pdf">ANSSI</a></p></li>
<li><p><a class="reference external" href="https://github.com/Neo23x0/auditd">Neo23x0</a></p></li>
<li><p><a class="reference external" href="https://highon.coffee/blog/security-harden-centos-7/#auditd---audit-daemon">highon.coffee</a></p></li>
<li><p><a class="reference external" href="https://github.com/linux-audit/audit-userspace/tree/master/rules">linux-audit</a></p></li>
<li><p><a class="reference external" href="https://connect.ed-diamond.com/GNU-Linux-Magazine/GLMFHS-093/Journalisez-les-actions-de-vos-utilisateurs-avec-Auditd">connect.ed-diamond.com</a></p></li>
<li><p><a class="reference external" href="https://linux-audit.com/configuring-and-auditing-linux-systems-with-audit-daemon/">linux-audit.com</a></p></li>
</ul>
</div>
<div class="section" id="procedures">
<h2>Procédures<a class="headerlink" href="#procedures" title="Permalink to this headline">¶</a></h2>
<p>Installons les paquets nécessaires au bon fonctionnement d’auditd :</p>
<p><img alt="../_images/1_install_package.PNG" src="../_images/1_install_package.PNG" /></p>
<p>Définissons ensuite les règles d’audit dans le /etc/auditd/audit.rules:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">## First rule - delete all</span>
<span class="o">-</span><span class="n">D</span>

<span class="c1">## Increase the buffers to survive stress events.</span>
<span class="c1">## Make this bigger for busy systems</span>
<span class="o">-</span><span class="n">b</span> <span class="mi">8192</span>

<span class="c1">## This determine how long to wait in burst of events</span>
<span class="o">--</span><span class="n">backlog_wait_time</span> <span class="mi">0</span>

<span class="c1">## Set failure mode to syslog</span>
<span class="o">-</span><span class="n">f</span> <span class="mi">1</span>

<span class="c1"># Ignore errors</span>
<span class="c1"># ## e.g. caused by users or files not found in the local environment</span>
<span class="o">-</span><span class="n">i</span>

<span class="c1">################################## SELF AUDITING ##################################</span>
<span class="c1">### Successful and unsuccessful attempts to read information from the audit records</span>
<span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">log</span><span class="o">/</span><span class="n">audit</span><span class="o">/</span> <span class="o">-</span><span class="n">k</span> <span class="n">auditlog</span>

<span class="c1">### Auditd configuration</span>
<span class="c1">#### Modifications to audit configuration that occur while the audit collection functions are operating</span>
<span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">audit</span><span class="o">/</span> <span class="o">-</span><span class="n">p</span> <span class="n">wa</span> <span class="o">-</span><span class="n">k</span> <span class="n">auditconfig</span>
<span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">libaudit</span><span class="o">.</span><span class="n">conf</span> <span class="o">-</span><span class="n">p</span> <span class="n">wa</span> <span class="o">-</span><span class="n">k</span> <span class="n">auditconfig</span>
<span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">audisp</span><span class="o">/</span> <span class="o">-</span><span class="n">p</span> <span class="n">wa</span> <span class="o">-</span><span class="n">k</span> <span class="n">audispconfig</span>

<span class="c1">### Monitor for use of audit management tools</span>
<span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">auditctl</span> <span class="o">-</span><span class="n">p</span> <span class="n">x</span> <span class="o">-</span><span class="n">k</span> <span class="n">audittools</span>
<span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">auditd</span> <span class="o">-</span><span class="n">p</span> <span class="n">x</span> <span class="o">-</span><span class="n">k</span> <span class="n">audittools</span>
<span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">augenrules</span> <span class="o">-</span><span class="n">p</span> <span class="n">x</span> <span class="o">-</span><span class="n">k</span> <span class="n">audittools</span>

<span class="c1">################################### RULES ##################################</span>
<span class="c1">## Kernel parameters</span>
<span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">sysctl</span><span class="o">.</span><span class="n">conf</span> <span class="o">-</span><span class="n">p</span> <span class="n">wa</span> <span class="o">-</span><span class="n">k</span> <span class="n">sysctl</span>
<span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">sysctl</span><span class="o">.</span><span class="n">d</span> <span class="o">-</span><span class="n">p</span> <span class="n">wa</span> <span class="o">-</span><span class="n">k</span> <span class="n">sysctl</span>

<span class="c1">### Kernel module loading and unloading</span>
<span class="o">-</span><span class="n">a</span> <span class="n">always</span><span class="p">,</span><span class="n">exit</span> <span class="o">-</span><span class="n">F</span> <span class="n">perm</span><span class="o">=</span><span class="n">x</span> <span class="o">-</span><span class="n">F</span> <span class="n">auid</span><span class="o">!=-</span><span class="mi">1</span> <span class="o">-</span><span class="n">F</span> <span class="n">path</span><span class="o">=/</span><span class="n">sbin</span><span class="o">/</span><span class="n">insmod</span> <span class="o">-</span><span class="n">k</span> <span class="n">modules</span>
<span class="o">-</span><span class="n">a</span> <span class="n">always</span><span class="p">,</span><span class="n">exit</span> <span class="o">-</span><span class="n">F</span> <span class="n">perm</span><span class="o">=</span><span class="n">x</span> <span class="o">-</span><span class="n">F</span> <span class="n">auid</span><span class="o">!=-</span><span class="mi">1</span> <span class="o">-</span><span class="n">F</span> <span class="n">path</span><span class="o">=/</span><span class="n">sbin</span><span class="o">/</span><span class="n">modprobe</span> <span class="o">-</span><span class="n">k</span> <span class="n">modules</span>
<span class="o">-</span><span class="n">a</span> <span class="n">always</span><span class="p">,</span><span class="n">exit</span> <span class="o">-</span><span class="n">F</span> <span class="n">perm</span><span class="o">=</span><span class="n">x</span> <span class="o">-</span><span class="n">F</span> <span class="n">auid</span><span class="o">!=-</span><span class="mi">1</span> <span class="o">-</span><span class="n">F</span> <span class="n">path</span><span class="o">=/</span><span class="n">sbin</span><span class="o">/</span><span class="n">rmmod</span> <span class="o">-</span><span class="n">k</span> <span class="n">modules</span>
<span class="o">-</span><span class="n">a</span> <span class="n">always</span><span class="p">,</span><span class="n">exit</span> <span class="o">-</span><span class="n">F</span> <span class="n">arch</span><span class="o">=</span><span class="n">b64</span> <span class="o">-</span><span class="n">S</span> <span class="n">finit_module</span> <span class="o">-</span><span class="n">S</span> <span class="n">init_module</span> <span class="o">-</span><span class="n">S</span> <span class="n">delete_module</span> <span class="o">-</span><span class="n">F</span> <span class="n">auid</span><span class="o">!=-</span><span class="mi">1</span> <span class="o">-</span><span class="n">k</span> <span class="n">modules</span>
<span class="o">-</span><span class="n">a</span> <span class="n">always</span><span class="p">,</span><span class="n">exit</span> <span class="o">-</span><span class="n">F</span> <span class="n">arch</span><span class="o">=</span><span class="n">b32</span> <span class="o">-</span><span class="n">S</span> <span class="n">finit_module</span> <span class="o">-</span><span class="n">S</span> <span class="n">init_module</span> <span class="o">-</span><span class="n">S</span> <span class="n">delete_module</span> <span class="o">-</span><span class="n">F</span> <span class="n">auid</span><span class="o">!=-</span><span class="mi">1</span> <span class="o">-</span><span class="n">k</span> <span class="n">modules</span>

<span class="c1">### Modprobe configuration</span>
<span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">modprobe</span><span class="o">.</span><span class="n">conf</span> <span class="o">-</span><span class="n">p</span> <span class="n">wa</span> <span class="o">-</span><span class="n">k</span> <span class="n">modprobe</span>
<span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">modprobe</span><span class="o">.</span><span class="n">d</span> <span class="o">-</span><span class="n">p</span> <span class="n">wa</span> <span class="o">-</span><span class="n">k</span> <span class="n">modprobe</span>

<span class="c1">### KExec usage (all actions)</span>
<span class="o">-</span><span class="n">a</span> <span class="n">always</span><span class="p">,</span><span class="n">exit</span> <span class="o">-</span><span class="n">F</span> <span class="n">arch</span><span class="o">=</span><span class="n">b64</span> <span class="o">-</span><span class="n">S</span> <span class="n">kexec_load</span> <span class="o">-</span><span class="n">k</span> <span class="n">KEXEC</span>
<span class="o">-</span><span class="n">a</span> <span class="n">always</span><span class="p">,</span><span class="n">exit</span> <span class="o">-</span><span class="n">F</span> <span class="n">arch</span><span class="o">=</span><span class="n">b32</span> <span class="o">-</span><span class="n">S</span> <span class="n">sys_kexec_load</span> <span class="o">-</span><span class="n">k</span> <span class="n">KEXEC</span>

<span class="c1">### Special files</span>
<span class="o">-</span><span class="n">a</span> <span class="n">always</span><span class="p">,</span><span class="n">exit</span> <span class="o">-</span><span class="n">F</span> <span class="n">arch</span><span class="o">=</span><span class="n">b32</span> <span class="o">-</span><span class="n">S</span> <span class="n">mknod</span> <span class="o">-</span><span class="n">S</span> <span class="n">mknodat</span> <span class="o">-</span><span class="n">k</span> <span class="n">specialfiles</span>
<span class="o">-</span><span class="n">a</span> <span class="n">always</span><span class="p">,</span><span class="n">exit</span> <span class="o">-</span><span class="n">F</span> <span class="n">arch</span><span class="o">=</span><span class="n">b64</span> <span class="o">-</span><span class="n">S</span> <span class="n">mknod</span> <span class="o">-</span><span class="n">S</span> <span class="n">mknodat</span> <span class="o">-</span><span class="n">k</span> <span class="n">specialfiles</span>

<span class="c1">### Mount operations (only attributable)</span>
<span class="o">-</span><span class="n">a</span> <span class="n">always</span><span class="p">,</span><span class="n">exit</span> <span class="o">-</span><span class="n">F</span> <span class="n">arch</span><span class="o">=</span><span class="n">b64</span> <span class="o">-</span><span class="n">S</span> <span class="n">mount</span> <span class="o">-</span><span class="n">S</span> <span class="n">umount2</span> <span class="o">-</span><span class="n">F</span> <span class="n">auid</span><span class="o">!=-</span><span class="mi">1</span> <span class="o">-</span><span class="n">k</span> <span class="n">mount</span>
<span class="o">-</span><span class="n">a</span> <span class="n">always</span><span class="p">,</span><span class="n">exit</span> <span class="o">-</span><span class="n">F</span> <span class="n">arch</span><span class="o">=</span><span class="n">b32</span> <span class="o">-</span><span class="n">S</span> <span class="n">mount</span> <span class="o">-</span><span class="n">S</span> <span class="n">umount</span> <span class="o">-</span><span class="n">S</span> <span class="n">umount2</span> <span class="o">-</span><span class="n">F</span> <span class="n">auid</span><span class="o">!=-</span><span class="mi">1</span> <span class="o">-</span><span class="n">k</span> <span class="n">mount</span>

<span class="c1">## Change swap (only attributable)</span>
<span class="o">-</span><span class="n">a</span> <span class="n">always</span><span class="p">,</span><span class="n">exit</span> <span class="o">-</span><span class="n">F</span> <span class="n">arch</span><span class="o">=</span><span class="n">b64</span> <span class="o">-</span><span class="n">S</span> <span class="n">swapon</span> <span class="o">-</span><span class="n">S</span> <span class="n">swapoff</span> <span class="o">-</span><span class="n">F</span> <span class="n">auid</span><span class="o">!=-</span><span class="mi">1</span> <span class="o">-</span><span class="n">k</span> <span class="n">swap</span>
<span class="o">-</span><span class="n">a</span> <span class="n">always</span><span class="p">,</span><span class="n">exit</span> <span class="o">-</span><span class="n">F</span> <span class="n">arch</span><span class="o">=</span><span class="n">b32</span> <span class="o">-</span><span class="n">S</span> <span class="n">swapon</span> <span class="o">-</span><span class="n">S</span> <span class="n">swapoff</span> <span class="o">-</span><span class="n">F</span> <span class="n">auid</span><span class="o">!=-</span><span class="mi">1</span> <span class="o">-</span><span class="n">k</span> <span class="n">swap</span>

<span class="c1">### Time</span>
<span class="o">-</span><span class="n">a</span> <span class="n">always</span><span class="p">,</span><span class="n">exit</span> <span class="o">-</span><span class="n">F</span> <span class="n">arch</span><span class="o">=</span><span class="n">b32</span> <span class="o">-</span><span class="n">S</span> <span class="n">adjtimex</span> <span class="o">-</span><span class="n">S</span> <span class="n">settimeofday</span> <span class="o">-</span><span class="n">S</span> <span class="n">clock_settime</span> <span class="o">-</span><span class="n">k</span> <span class="n">time</span>
<span class="o">-</span><span class="n">a</span> <span class="n">always</span><span class="p">,</span><span class="n">exit</span> <span class="o">-</span><span class="n">F</span> <span class="n">arch</span><span class="o">=</span><span class="n">b64</span> <span class="o">-</span><span class="n">S</span> <span class="n">adjtimex</span> <span class="o">-</span><span class="n">S</span> <span class="n">settimeofday</span> <span class="o">-</span><span class="n">S</span> <span class="n">clock_settime</span> <span class="o">-</span><span class="n">k</span> <span class="n">time</span>

<span class="c1">#### Local time zone</span>
<span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">localtime</span> <span class="o">-</span><span class="n">p</span> <span class="n">wa</span> <span class="o">-</span><span class="n">k</span> <span class="n">localtime</span>

<span class="c1">### Stunnel</span>
<span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">stunnel</span> <span class="o">-</span><span class="n">p</span> <span class="n">x</span> <span class="o">-</span><span class="n">k</span> <span class="n">stunnel</span>
<span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">stunnel</span> <span class="o">-</span><span class="n">p</span> <span class="n">x</span> <span class="o">-</span><span class="n">k</span> <span class="n">stunnel</span>

<span class="c1">### Cron configuration &amp; scheduled jobs</span>
<span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">cron</span><span class="o">.</span><span class="n">allow</span> <span class="o">-</span><span class="n">p</span> <span class="n">wa</span> <span class="o">-</span><span class="n">k</span> <span class="n">cron</span>
<span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">cron</span><span class="o">.</span><span class="n">deny</span> <span class="o">-</span><span class="n">p</span> <span class="n">wa</span> <span class="o">-</span><span class="n">k</span> <span class="n">cron</span>
<span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">cron</span><span class="o">.</span><span class="n">d</span><span class="o">/</span> <span class="o">-</span><span class="n">p</span> <span class="n">wa</span> <span class="o">-</span><span class="n">k</span> <span class="n">cron</span>
<span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">cron</span><span class="o">.</span><span class="n">daily</span><span class="o">/</span> <span class="o">-</span><span class="n">p</span> <span class="n">wa</span> <span class="o">-</span><span class="n">k</span> <span class="n">cron</span>
<span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">cron</span><span class="o">.</span><span class="n">hourly</span><span class="o">/</span> <span class="o">-</span><span class="n">p</span> <span class="n">wa</span> <span class="o">-</span><span class="n">k</span> <span class="n">cron</span>
<span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">cron</span><span class="o">.</span><span class="n">monthly</span><span class="o">/</span> <span class="o">-</span><span class="n">p</span> <span class="n">wa</span> <span class="o">-</span><span class="n">k</span> <span class="n">cron</span>
<span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">cron</span><span class="o">.</span><span class="n">weekly</span><span class="o">/</span> <span class="o">-</span><span class="n">p</span> <span class="n">wa</span> <span class="o">-</span><span class="n">k</span> <span class="n">cron</span>
<span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">crontab</span> <span class="o">-</span><span class="n">p</span> <span class="n">wa</span> <span class="o">-</span><span class="n">k</span> <span class="n">cron</span>
<span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">spool</span><span class="o">/</span><span class="n">cron</span><span class="o">/</span> <span class="o">-</span><span class="n">k</span> <span class="n">cron</span>

<span class="c1">### User, group, password databases</span>
<span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">group</span> <span class="o">-</span><span class="n">p</span> <span class="n">wa</span> <span class="o">-</span><span class="n">k</span> <span class="n">etcgroup</span>
<span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">passwd</span> <span class="o">-</span><span class="n">p</span> <span class="n">wa</span> <span class="o">-</span><span class="n">k</span> <span class="n">etcpasswd</span>
<span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">gshadow</span> <span class="o">-</span><span class="n">k</span> <span class="n">etcgroup</span>
<span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">shadow</span> <span class="o">-</span><span class="n">k</span> <span class="n">etcpasswd</span>
<span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">security</span><span class="o">/</span><span class="n">opasswd</span> <span class="o">-</span><span class="n">k</span> <span class="n">opasswd</span>

<span class="c1">### Sudoers file changes</span>
<span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">sudoers</span> <span class="o">-</span><span class="n">p</span> <span class="n">wa</span> <span class="o">-</span><span class="n">k</span> <span class="n">actions</span>
<span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">sudoers</span><span class="o">.</span><span class="n">d</span><span class="o">/</span> <span class="o">-</span><span class="n">p</span> <span class="n">wa</span> <span class="o">-</span><span class="n">k</span> <span class="n">actions</span>

<span class="c1">### Passwd</span>
<span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">passwd</span> <span class="o">-</span><span class="n">p</span> <span class="n">x</span> <span class="o">-</span><span class="n">k</span> <span class="n">passwd_modification</span>

<span class="c1">### Tools to change group identifiers</span>
<span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">groupadd</span> <span class="o">-</span><span class="n">p</span> <span class="n">x</span> <span class="o">-</span><span class="n">k</span> <span class="n">group_modification</span>
<span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">groupmod</span> <span class="o">-</span><span class="n">p</span> <span class="n">x</span> <span class="o">-</span><span class="n">k</span> <span class="n">group_modification</span>
<span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">addgroup</span> <span class="o">-</span><span class="n">p</span> <span class="n">x</span> <span class="o">-</span><span class="n">k</span> <span class="n">group_modification</span>
<span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">useradd</span> <span class="o">-</span><span class="n">p</span> <span class="n">x</span> <span class="o">-</span><span class="n">k</span> <span class="n">user_modification</span>
<span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">userdel</span> <span class="o">-</span><span class="n">p</span> <span class="n">x</span> <span class="o">-</span><span class="n">k</span> <span class="n">user_modification</span>
<span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">usermod</span> <span class="o">-</span><span class="n">p</span> <span class="n">x</span> <span class="o">-</span><span class="n">k</span> <span class="n">user_modification</span>
<span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">adduser</span> <span class="o">-</span><span class="n">p</span> <span class="n">x</span> <span class="o">-</span><span class="n">k</span> <span class="n">user_modification</span>

<span class="c1">### Login configuration and information</span>
<span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">login</span><span class="o">.</span><span class="n">defs</span> <span class="o">-</span><span class="n">p</span> <span class="n">wa</span> <span class="o">-</span><span class="n">k</span> <span class="n">login</span>
<span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">securetty</span> <span class="o">-</span><span class="n">p</span> <span class="n">wa</span> <span class="o">-</span><span class="n">k</span> <span class="n">login</span>
<span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">log</span><span class="o">/</span><span class="n">faillog</span> <span class="o">-</span><span class="n">p</span> <span class="n">wa</span> <span class="o">-</span><span class="n">k</span> <span class="n">login</span>
<span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">log</span><span class="o">/</span><span class="n">lastlog</span> <span class="o">-</span><span class="n">p</span> <span class="n">wa</span> <span class="o">-</span><span class="n">k</span> <span class="n">login</span>
<span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">log</span><span class="o">/</span><span class="n">tallylog</span> <span class="o">-</span><span class="n">p</span> <span class="n">wa</span> <span class="o">-</span><span class="n">k</span> <span class="n">login</span>

<span class="c1">### Network Environment</span>
<span class="c1">#### Changes to hostname</span>
<span class="o">-</span><span class="n">a</span> <span class="n">always</span><span class="p">,</span><span class="n">exit</span> <span class="o">-</span><span class="n">F</span> <span class="n">arch</span><span class="o">=</span><span class="n">b32</span> <span class="o">-</span><span class="n">S</span> <span class="n">sethostname</span> <span class="o">-</span><span class="n">S</span> <span class="n">setdomainname</span> <span class="o">-</span><span class="n">k</span> <span class="n">network_modifications</span>
<span class="o">-</span><span class="n">a</span> <span class="n">always</span><span class="p">,</span><span class="n">exit</span> <span class="o">-</span><span class="n">F</span> <span class="n">arch</span><span class="o">=</span><span class="n">b64</span> <span class="o">-</span><span class="n">S</span> <span class="n">sethostname</span> <span class="o">-</span><span class="n">S</span> <span class="n">setdomainname</span> <span class="o">-</span><span class="n">k</span> <span class="n">network_modifications</span>

<span class="c1">### Successful IPv4 Connections</span>
<span class="o">-</span><span class="n">a</span> <span class="n">always</span><span class="p">,</span><span class="n">exit</span> <span class="o">-</span><span class="n">F</span> <span class="n">arch</span><span class="o">=</span><span class="n">b64</span> <span class="o">-</span><span class="n">S</span> <span class="n">connect</span> <span class="o">-</span><span class="n">F</span> <span class="n">a2</span><span class="o">=</span><span class="mi">16</span> <span class="o">-</span><span class="n">F</span> <span class="n">success</span><span class="o">=</span><span class="mi">1</span> <span class="o">-</span><span class="n">F</span> <span class="n">key</span><span class="o">=</span><span class="n">network_connect_4</span>
<span class="o">-</span><span class="n">a</span> <span class="n">always</span><span class="p">,</span><span class="n">exit</span> <span class="o">-</span><span class="n">F</span> <span class="n">arch</span><span class="o">=</span><span class="n">b32</span> <span class="o">-</span><span class="n">S</span> <span class="n">connect</span> <span class="o">-</span><span class="n">F</span> <span class="n">a2</span><span class="o">=</span><span class="mi">16</span> <span class="o">-</span><span class="n">F</span> <span class="n">success</span><span class="o">=</span><span class="mi">1</span> <span class="o">-</span><span class="n">F</span> <span class="n">key</span><span class="o">=</span><span class="n">network_connect_4</span>

<span class="c1">### Successful IPv6 Connections</span>
<span class="o">-</span><span class="n">a</span> <span class="n">always</span><span class="p">,</span><span class="n">exit</span> <span class="o">-</span><span class="n">F</span> <span class="n">arch</span><span class="o">=</span><span class="n">b64</span> <span class="o">-</span><span class="n">S</span> <span class="n">connect</span> <span class="o">-</span><span class="n">F</span> <span class="n">a2</span><span class="o">=</span><span class="mi">28</span> <span class="o">-</span><span class="n">F</span> <span class="n">success</span><span class="o">=</span><span class="mi">1</span> <span class="o">-</span><span class="n">F</span> <span class="n">key</span><span class="o">=</span><span class="n">network_connect_6</span>
<span class="o">-</span><span class="n">a</span> <span class="n">always</span><span class="p">,</span><span class="n">exit</span> <span class="o">-</span><span class="n">F</span> <span class="n">arch</span><span class="o">=</span><span class="n">b32</span> <span class="o">-</span><span class="n">S</span> <span class="n">connect</span> <span class="o">-</span><span class="n">F</span> <span class="n">a2</span><span class="o">=</span><span class="mi">28</span> <span class="o">-</span><span class="n">F</span> <span class="n">success</span><span class="o">=</span><span class="mi">1</span> <span class="o">-</span><span class="n">F</span> <span class="n">key</span><span class="o">=</span><span class="n">network_connect_6</span>

<span class="c1">#### Changes to other files</span>
<span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">hosts</span> <span class="o">-</span><span class="n">p</span> <span class="n">wa</span> <span class="o">-</span><span class="n">k</span> <span class="n">network_modifications</span>
<span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">sysconfig</span><span class="o">/</span><span class="n">network</span> <span class="o">-</span><span class="n">p</span> <span class="n">wa</span> <span class="o">-</span><span class="n">k</span> <span class="n">network_modifications</span>
<span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">sysconfig</span><span class="o">/</span><span class="n">network</span><span class="o">-</span><span class="n">scripts</span> <span class="o">-</span><span class="n">p</span> <span class="n">w</span> <span class="o">-</span><span class="n">k</span> <span class="n">network_modifications</span>
<span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">network</span><span class="o">/</span> <span class="o">-</span><span class="n">p</span> <span class="n">wa</span> <span class="o">-</span><span class="n">k</span> <span class="n">network</span>
<span class="o">-</span><span class="n">a</span> <span class="n">always</span><span class="p">,</span><span class="n">exit</span> <span class="o">-</span><span class="n">F</span> <span class="nb">dir</span><span class="o">=/</span><span class="n">etc</span><span class="o">/</span><span class="n">NetworkManager</span><span class="o">/</span> <span class="o">-</span><span class="n">F</span> <span class="n">perm</span><span class="o">=</span><span class="n">wa</span> <span class="o">-</span><span class="n">k</span> <span class="n">network_modifications</span>

<span class="c1">#### Changes to issue</span>
<span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">issue</span> <span class="o">-</span><span class="n">p</span> <span class="n">wa</span> <span class="o">-</span><span class="n">k</span> <span class="n">etcissue</span>
<span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">issue</span><span class="o">.</span><span class="n">net</span> <span class="o">-</span><span class="n">p</span> <span class="n">wa</span> <span class="o">-</span><span class="n">k</span> <span class="n">etcissue</span>

<span class="c1">### System startup scripts</span>
<span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">inittab</span> <span class="o">-</span><span class="n">p</span> <span class="n">wa</span> <span class="o">-</span><span class="n">k</span> <span class="n">init</span>
<span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">init</span><span class="o">.</span><span class="n">d</span><span class="o">/</span> <span class="o">-</span><span class="n">p</span> <span class="n">wa</span> <span class="o">-</span><span class="n">k</span> <span class="n">init</span>
<span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">init</span><span class="o">/</span> <span class="o">-</span><span class="n">p</span> <span class="n">wa</span> <span class="o">-</span><span class="n">k</span> <span class="n">init</span>

<span class="c1">### Library search paths</span>
<span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">ld</span><span class="o">.</span><span class="n">so</span><span class="o">.</span><span class="n">conf</span> <span class="o">-</span><span class="n">p</span> <span class="n">wa</span> <span class="o">-</span><span class="n">k</span> <span class="n">libpath</span>
<span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">ld</span><span class="o">.</span><span class="n">so</span><span class="o">.</span><span class="n">conf</span><span class="o">.</span><span class="n">d</span> <span class="o">-</span><span class="n">p</span> <span class="n">wa</span> <span class="o">-</span><span class="n">k</span> <span class="n">libpath</span>

<span class="c1">### Systemwide library preloads (LD_PRELOAD)</span>
<span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">ld</span><span class="o">.</span><span class="n">so</span><span class="o">.</span><span class="n">preload</span> <span class="o">-</span><span class="n">p</span> <span class="n">wa</span> <span class="o">-</span><span class="n">k</span> <span class="n">systemwide_preloads</span>

<span class="c1">### Pam configuration</span>
<span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">pam</span><span class="o">.</span><span class="n">d</span><span class="o">/</span> <span class="o">-</span><span class="n">p</span> <span class="n">wa</span> <span class="o">-</span><span class="n">k</span> <span class="n">pam</span>
<span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">security</span><span class="o">/</span><span class="n">limits</span><span class="o">.</span><span class="n">conf</span> <span class="o">-</span><span class="n">p</span> <span class="n">wa</span>  <span class="o">-</span><span class="n">k</span> <span class="n">pam</span>
<span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">security</span><span class="o">/</span><span class="n">limits</span><span class="o">.</span><span class="n">d</span> <span class="o">-</span><span class="n">p</span> <span class="n">wa</span>  <span class="o">-</span><span class="n">k</span> <span class="n">pam</span>
<span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">security</span><span class="o">/</span><span class="n">pam_env</span><span class="o">.</span><span class="n">conf</span> <span class="o">-</span><span class="n">p</span> <span class="n">wa</span> <span class="o">-</span><span class="n">k</span> <span class="n">pam</span>
<span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">security</span><span class="o">/</span><span class="n">namespace</span><span class="o">.</span><span class="n">conf</span> <span class="o">-</span><span class="n">p</span> <span class="n">wa</span> <span class="o">-</span><span class="n">k</span> <span class="n">pam</span>
<span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">security</span><span class="o">/</span><span class="n">namespace</span><span class="o">.</span><span class="n">d</span> <span class="o">-</span><span class="n">p</span> <span class="n">wa</span> <span class="o">-</span><span class="n">k</span> <span class="n">pam</span>
<span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">security</span><span class="o">/</span><span class="n">namespace</span><span class="o">.</span><span class="n">init</span> <span class="o">-</span><span class="n">p</span> <span class="n">wa</span> <span class="o">-</span><span class="n">k</span> <span class="n">pam</span>

<span class="c1">### Mail configuration</span>
<span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">aliases</span> <span class="o">-</span><span class="n">p</span> <span class="n">wa</span> <span class="o">-</span><span class="n">k</span> <span class="n">mail</span>
<span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">postfix</span><span class="o">/</span> <span class="o">-</span><span class="n">p</span> <span class="n">wa</span> <span class="o">-</span><span class="n">k</span> <span class="n">mail</span>
<span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">exim4</span><span class="o">/</span> <span class="o">-</span><span class="n">p</span> <span class="n">wa</span> <span class="o">-</span><span class="n">k</span> <span class="n">mail</span>

<span class="c1">### SSH configuration</span>
<span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">ssh</span><span class="o">/</span><span class="n">sshd_config</span> <span class="o">-</span><span class="n">k</span> <span class="n">sshd</span>
<span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">ssh</span><span class="o">/</span><span class="n">sshd_config</span><span class="o">.</span><span class="n">d</span> <span class="o">-</span><span class="n">k</span> <span class="n">sshd</span>

<span class="c1">### root ssh key tampering</span>
<span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="n">root</span><span class="o">/.</span><span class="n">ssh</span> <span class="o">-</span><span class="n">p</span> <span class="n">wa</span> <span class="o">-</span><span class="n">k</span> <span class="n">rootkey</span>

<span class="c1">## Systemd</span>
<span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">systemctl</span> <span class="o">-</span><span class="n">p</span> <span class="n">x</span> <span class="o">-</span><span class="n">k</span> <span class="n">systemd</span>
<span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">systemd</span><span class="o">/</span> <span class="o">-</span><span class="n">p</span> <span class="n">wa</span> <span class="o">-</span><span class="n">k</span> <span class="n">systemd</span>

<span class="c1">### SELinux events that modify the system&#39;s Mandatory Access Controls (MAC)</span>
<span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">selinux</span><span class="o">/</span> <span class="o">-</span><span class="n">p</span> <span class="n">wa</span> <span class="o">-</span><span class="n">k</span> <span class="n">mac_policy</span>

<span class="c1">### Critical elements access failures</span>
<span class="o">-</span><span class="n">a</span> <span class="n">always</span><span class="p">,</span><span class="n">exit</span> <span class="o">-</span><span class="n">F</span> <span class="n">arch</span><span class="o">=</span><span class="n">b64</span> <span class="o">-</span><span class="n">S</span> <span class="nb">open</span> <span class="o">-</span><span class="n">F</span> <span class="nb">dir</span><span class="o">=/</span><span class="n">etc</span> <span class="o">-</span><span class="n">F</span> <span class="n">success</span><span class="o">=</span><span class="mi">0</span> <span class="o">-</span><span class="n">k</span> <span class="n">unauthedfileaccess</span>
<span class="o">-</span><span class="n">a</span> <span class="n">always</span><span class="p">,</span><span class="n">exit</span> <span class="o">-</span><span class="n">F</span> <span class="n">arch</span><span class="o">=</span><span class="n">b64</span> <span class="o">-</span><span class="n">S</span> <span class="nb">open</span> <span class="o">-</span><span class="n">F</span> <span class="nb">dir</span><span class="o">=/</span><span class="nb">bin</span> <span class="o">-</span><span class="n">F</span> <span class="n">success</span><span class="o">=</span><span class="mi">0</span> <span class="o">-</span><span class="n">k</span> <span class="n">unauthedfileaccess</span>
<span class="o">-</span><span class="n">a</span> <span class="n">always</span><span class="p">,</span><span class="n">exit</span> <span class="o">-</span><span class="n">F</span> <span class="n">arch</span><span class="o">=</span><span class="n">b64</span> <span class="o">-</span><span class="n">S</span> <span class="nb">open</span> <span class="o">-</span><span class="n">F</span> <span class="nb">dir</span><span class="o">=/</span><span class="n">sbin</span> <span class="o">-</span><span class="n">F</span> <span class="n">success</span><span class="o">=</span><span class="mi">0</span> <span class="o">-</span><span class="n">k</span> <span class="n">unauthedfileaccess</span>
<span class="o">-</span><span class="n">a</span> <span class="n">always</span><span class="p">,</span><span class="n">exit</span> <span class="o">-</span><span class="n">F</span> <span class="n">arch</span><span class="o">=</span><span class="n">b64</span> <span class="o">-</span><span class="n">S</span> <span class="nb">open</span> <span class="o">-</span><span class="n">F</span> <span class="nb">dir</span><span class="o">=/</span><span class="n">usr</span><span class="o">/</span><span class="nb">bin</span> <span class="o">-</span><span class="n">F</span> <span class="n">success</span><span class="o">=</span><span class="mi">0</span> <span class="o">-</span><span class="n">k</span> <span class="n">unauthedfileaccess</span>
<span class="o">-</span><span class="n">a</span> <span class="n">always</span><span class="p">,</span><span class="n">exit</span> <span class="o">-</span><span class="n">F</span> <span class="n">arch</span><span class="o">=</span><span class="n">b64</span> <span class="o">-</span><span class="n">S</span> <span class="nb">open</span> <span class="o">-</span><span class="n">F</span> <span class="nb">dir</span><span class="o">=/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span> <span class="o">-</span><span class="n">F</span> <span class="n">success</span><span class="o">=</span><span class="mi">0</span> <span class="o">-</span><span class="n">k</span> <span class="n">unauthedfileaccess</span>
<span class="o">-</span><span class="n">a</span> <span class="n">always</span><span class="p">,</span><span class="n">exit</span> <span class="o">-</span><span class="n">F</span> <span class="n">arch</span><span class="o">=</span><span class="n">b64</span> <span class="o">-</span><span class="n">S</span> <span class="nb">open</span> <span class="o">-</span><span class="n">F</span> <span class="nb">dir</span><span class="o">=/</span><span class="n">var</span> <span class="o">-</span><span class="n">F</span> <span class="n">success</span><span class="o">=</span><span class="mi">0</span> <span class="o">-</span><span class="n">k</span> <span class="n">unauthedfileaccess</span>
<span class="o">-</span><span class="n">a</span> <span class="n">always</span><span class="p">,</span><span class="n">exit</span> <span class="o">-</span><span class="n">F</span> <span class="n">arch</span><span class="o">=</span><span class="n">b64</span> <span class="o">-</span><span class="n">S</span> <span class="nb">open</span> <span class="o">-</span><span class="n">F</span> <span class="nb">dir</span><span class="o">=/</span><span class="n">home</span> <span class="o">-</span><span class="n">F</span> <span class="n">success</span><span class="o">=</span><span class="mi">0</span> <span class="o">-</span><span class="n">k</span> <span class="n">unauthedfileaccess</span>
<span class="o">-</span><span class="n">a</span> <span class="n">always</span><span class="p">,</span><span class="n">exit</span> <span class="o">-</span><span class="n">F</span> <span class="n">arch</span><span class="o">=</span><span class="n">b64</span> <span class="o">-</span><span class="n">S</span> <span class="nb">open</span> <span class="o">-</span><span class="n">F</span> <span class="nb">dir</span><span class="o">=/</span><span class="n">srv</span> <span class="o">-</span><span class="n">F</span> <span class="n">success</span><span class="o">=</span><span class="mi">0</span> <span class="o">-</span><span class="n">k</span> <span class="n">unauthedfileaccess</span>

<span class="c1">### Process ID change (switching accounts) applications</span>
<span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">su</span> <span class="o">-</span><span class="n">p</span> <span class="n">x</span> <span class="o">-</span><span class="n">k</span> <span class="n">priv_esc</span>
<span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">sudo</span> <span class="o">-</span><span class="n">p</span> <span class="n">x</span> <span class="o">-</span><span class="n">k</span> <span class="n">priv_esc</span>
<span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">sudoers</span> <span class="o">-</span><span class="n">p</span> <span class="n">rw</span> <span class="o">-</span><span class="n">k</span> <span class="n">priv_esc</span>
<span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">sudoers</span><span class="o">.</span><span class="n">d</span> <span class="o">-</span><span class="n">p</span> <span class="n">rw</span> <span class="o">-</span><span class="n">k</span> <span class="n">priv_esc</span>

<span class="c1">### Power state</span>
<span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">shutdown</span> <span class="o">-</span><span class="n">p</span> <span class="n">x</span> <span class="o">-</span><span class="n">k</span> <span class="n">power</span>
<span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">poweroff</span> <span class="o">-</span><span class="n">p</span> <span class="n">x</span> <span class="o">-</span><span class="n">k</span> <span class="n">power</span>
<span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">reboot</span> <span class="o">-</span><span class="n">p</span> <span class="n">x</span> <span class="o">-</span><span class="n">k</span> <span class="n">power</span>
<span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">halt</span> <span class="o">-</span><span class="n">p</span> <span class="n">x</span> <span class="o">-</span><span class="n">k</span> <span class="n">power</span>

<span class="c1">### Session initiation information</span>
<span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">run</span><span class="o">/</span><span class="n">utmp</span> <span class="o">-</span><span class="n">p</span> <span class="n">wa</span> <span class="o">-</span><span class="n">k</span> <span class="n">session</span>
<span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">log</span><span class="o">/</span><span class="n">btmp</span> <span class="o">-</span><span class="n">p</span> <span class="n">wa</span> <span class="o">-</span><span class="n">k</span> <span class="n">session</span>
<span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">log</span><span class="o">/</span><span class="n">wtmp</span> <span class="o">-</span><span class="n">p</span> <span class="n">wa</span> <span class="o">-</span><span class="n">k</span> <span class="n">session</span>

<span class="c1">### Discretionary Access Control (DAC) modifications</span>
<span class="o">-</span><span class="n">a</span> <span class="n">always</span><span class="p">,</span><span class="n">exit</span> <span class="o">-</span><span class="n">F</span> <span class="n">arch</span><span class="o">=</span><span class="n">b32</span> <span class="o">-</span><span class="n">S</span> <span class="n">chmod</span> <span class="o">-</span><span class="n">F</span> <span class="n">auid</span><span class="o">&gt;=</span><span class="mi">1000</span> <span class="o">-</span><span class="n">F</span> <span class="n">auid</span><span class="o">!=-</span><span class="mi">1</span> <span class="o">-</span><span class="n">k</span> <span class="n">perm_mod</span>
<span class="o">-</span><span class="n">a</span> <span class="n">always</span><span class="p">,</span><span class="n">exit</span> <span class="o">-</span><span class="n">F</span> <span class="n">arch</span><span class="o">=</span><span class="n">b32</span> <span class="o">-</span><span class="n">S</span> <span class="n">chown</span> <span class="o">-</span><span class="n">F</span> <span class="n">auid</span><span class="o">&gt;=</span><span class="mi">1000</span> <span class="o">-</span><span class="n">F</span> <span class="n">auid</span><span class="o">!=-</span><span class="mi">1</span> <span class="o">-</span><span class="n">k</span> <span class="n">perm_mod</span>
<span class="o">-</span><span class="n">a</span> <span class="n">always</span><span class="p">,</span><span class="n">exit</span> <span class="o">-</span><span class="n">F</span> <span class="n">arch</span><span class="o">=</span><span class="n">b32</span> <span class="o">-</span><span class="n">S</span> <span class="n">fchmod</span> <span class="o">-</span><span class="n">F</span> <span class="n">auid</span><span class="o">&gt;=</span><span class="mi">1000</span> <span class="o">-</span><span class="n">F</span> <span class="n">auid</span><span class="o">!=-</span><span class="mi">1</span> <span class="o">-</span><span class="n">k</span> <span class="n">perm_mod</span>
<span class="o">-</span><span class="n">a</span> <span class="n">always</span><span class="p">,</span><span class="n">exit</span> <span class="o">-</span><span class="n">F</span> <span class="n">arch</span><span class="o">=</span><span class="n">b32</span> <span class="o">-</span><span class="n">S</span> <span class="n">fchmodat</span> <span class="o">-</span><span class="n">F</span> <span class="n">auid</span><span class="o">&gt;=</span><span class="mi">1000</span> <span class="o">-</span><span class="n">F</span> <span class="n">auid</span><span class="o">!=-</span><span class="mi">1</span> <span class="o">-</span><span class="n">k</span> <span class="n">perm_mod</span>
<span class="o">-</span><span class="n">a</span> <span class="n">always</span><span class="p">,</span><span class="n">exit</span> <span class="o">-</span><span class="n">F</span> <span class="n">arch</span><span class="o">=</span><span class="n">b32</span> <span class="o">-</span><span class="n">S</span> <span class="n">fchown</span> <span class="o">-</span><span class="n">F</span> <span class="n">auid</span><span class="o">&gt;=</span><span class="mi">1000</span> <span class="o">-</span><span class="n">F</span> <span class="n">auid</span><span class="o">!=-</span><span class="mi">1</span> <span class="o">-</span><span class="n">k</span> <span class="n">perm_mod</span>
<span class="o">-</span><span class="n">a</span> <span class="n">always</span><span class="p">,</span><span class="n">exit</span> <span class="o">-</span><span class="n">F</span> <span class="n">arch</span><span class="o">=</span><span class="n">b32</span> <span class="o">-</span><span class="n">S</span> <span class="n">fchownat</span> <span class="o">-</span><span class="n">F</span> <span class="n">auid</span><span class="o">&gt;=</span><span class="mi">1000</span> <span class="o">-</span><span class="n">F</span> <span class="n">auid</span><span class="o">!=-</span><span class="mi">1</span> <span class="o">-</span><span class="n">k</span> <span class="n">perm_mod</span>
<span class="o">-</span><span class="n">a</span> <span class="n">always</span><span class="p">,</span><span class="n">exit</span> <span class="o">-</span><span class="n">F</span> <span class="n">arch</span><span class="o">=</span><span class="n">b32</span> <span class="o">-</span><span class="n">S</span> <span class="n">fremovexattr</span> <span class="o">-</span><span class="n">F</span> <span class="n">auid</span><span class="o">&gt;=</span><span class="mi">1000</span> <span class="o">-</span><span class="n">F</span> <span class="n">auid</span><span class="o">!=-</span><span class="mi">1</span> <span class="o">-</span><span class="n">k</span> <span class="n">perm_mod</span>
<span class="o">-</span><span class="n">a</span> <span class="n">always</span><span class="p">,</span><span class="n">exit</span> <span class="o">-</span><span class="n">F</span> <span class="n">arch</span><span class="o">=</span><span class="n">b32</span> <span class="o">-</span><span class="n">S</span> <span class="n">fsetxattr</span> <span class="o">-</span><span class="n">F</span> <span class="n">auid</span><span class="o">&gt;=</span><span class="mi">1000</span> <span class="o">-</span><span class="n">F</span> <span class="n">auid</span><span class="o">!=-</span><span class="mi">1</span> <span class="o">-</span><span class="n">k</span> <span class="n">perm_mod</span>
<span class="o">-</span><span class="n">a</span> <span class="n">always</span><span class="p">,</span><span class="n">exit</span> <span class="o">-</span><span class="n">F</span> <span class="n">arch</span><span class="o">=</span><span class="n">b32</span> <span class="o">-</span><span class="n">S</span> <span class="n">lchown</span> <span class="o">-</span><span class="n">F</span> <span class="n">auid</span><span class="o">&gt;=</span><span class="mi">1000</span> <span class="o">-</span><span class="n">F</span> <span class="n">auid</span><span class="o">!=-</span><span class="mi">1</span> <span class="o">-</span><span class="n">k</span> <span class="n">perm_mod</span>
<span class="o">-</span><span class="n">a</span> <span class="n">always</span><span class="p">,</span><span class="n">exit</span> <span class="o">-</span><span class="n">F</span> <span class="n">arch</span><span class="o">=</span><span class="n">b32</span> <span class="o">-</span><span class="n">S</span> <span class="n">lremovexattr</span> <span class="o">-</span><span class="n">F</span> <span class="n">auid</span><span class="o">&gt;=</span><span class="mi">1000</span> <span class="o">-</span><span class="n">F</span> <span class="n">auid</span><span class="o">!=-</span><span class="mi">1</span> <span class="o">-</span><span class="n">k</span> <span class="n">perm_mod</span>
<span class="o">-</span><span class="n">a</span> <span class="n">always</span><span class="p">,</span><span class="n">exit</span> <span class="o">-</span><span class="n">F</span> <span class="n">arch</span><span class="o">=</span><span class="n">b32</span> <span class="o">-</span><span class="n">S</span> <span class="n">lsetxattr</span> <span class="o">-</span><span class="n">F</span> <span class="n">auid</span><span class="o">&gt;=</span><span class="mi">1000</span> <span class="o">-</span><span class="n">F</span> <span class="n">auid</span><span class="o">!=-</span><span class="mi">1</span> <span class="o">-</span><span class="n">k</span> <span class="n">perm_mod</span>
<span class="o">-</span><span class="n">a</span> <span class="n">always</span><span class="p">,</span><span class="n">exit</span> <span class="o">-</span><span class="n">F</span> <span class="n">arch</span><span class="o">=</span><span class="n">b32</span> <span class="o">-</span><span class="n">S</span> <span class="n">removexattr</span> <span class="o">-</span><span class="n">F</span> <span class="n">auid</span><span class="o">&gt;=</span><span class="mi">1000</span> <span class="o">-</span><span class="n">F</span> <span class="n">auid</span><span class="o">!=-</span><span class="mi">1</span> <span class="o">-</span><span class="n">k</span> <span class="n">perm_mod</span>
<span class="o">-</span><span class="n">a</span> <span class="n">always</span><span class="p">,</span><span class="n">exit</span> <span class="o">-</span><span class="n">F</span> <span class="n">arch</span><span class="o">=</span><span class="n">b32</span> <span class="o">-</span><span class="n">S</span> <span class="n">setxattr</span> <span class="o">-</span><span class="n">F</span> <span class="n">auid</span><span class="o">&gt;=</span><span class="mi">1000</span> <span class="o">-</span><span class="n">F</span> <span class="n">auid</span><span class="o">!=-</span><span class="mi">1</span> <span class="o">-</span><span class="n">k</span> <span class="n">perm_mod</span>
<span class="o">-</span><span class="n">a</span> <span class="n">always</span><span class="p">,</span><span class="n">exit</span> <span class="o">-</span><span class="n">F</span> <span class="n">arch</span><span class="o">=</span><span class="n">b64</span> <span class="o">-</span><span class="n">S</span> <span class="n">chmod</span>  <span class="o">-</span><span class="n">F</span> <span class="n">auid</span><span class="o">&gt;=</span><span class="mi">1000</span> <span class="o">-</span><span class="n">F</span> <span class="n">auid</span><span class="o">!=-</span><span class="mi">1</span> <span class="o">-</span><span class="n">k</span> <span class="n">perm_mod</span>
<span class="o">-</span><span class="n">a</span> <span class="n">always</span><span class="p">,</span><span class="n">exit</span> <span class="o">-</span><span class="n">F</span> <span class="n">arch</span><span class="o">=</span><span class="n">b64</span> <span class="o">-</span><span class="n">S</span> <span class="n">chown</span> <span class="o">-</span><span class="n">F</span> <span class="n">auid</span><span class="o">&gt;=</span><span class="mi">1000</span> <span class="o">-</span><span class="n">F</span> <span class="n">auid</span><span class="o">!=-</span><span class="mi">1</span> <span class="o">-</span><span class="n">k</span> <span class="n">perm_mod</span>
<span class="o">-</span><span class="n">a</span> <span class="n">always</span><span class="p">,</span><span class="n">exit</span> <span class="o">-</span><span class="n">F</span> <span class="n">arch</span><span class="o">=</span><span class="n">b64</span> <span class="o">-</span><span class="n">S</span> <span class="n">fchmod</span> <span class="o">-</span><span class="n">F</span> <span class="n">auid</span><span class="o">&gt;=</span><span class="mi">1000</span> <span class="o">-</span><span class="n">F</span> <span class="n">auid</span><span class="o">!=-</span><span class="mi">1</span> <span class="o">-</span><span class="n">k</span> <span class="n">perm_mod</span>
<span class="o">-</span><span class="n">a</span> <span class="n">always</span><span class="p">,</span><span class="n">exit</span> <span class="o">-</span><span class="n">F</span> <span class="n">arch</span><span class="o">=</span><span class="n">b64</span> <span class="o">-</span><span class="n">S</span> <span class="n">fchmodat</span> <span class="o">-</span><span class="n">F</span> <span class="n">auid</span><span class="o">&gt;=</span><span class="mi">1000</span> <span class="o">-</span><span class="n">F</span> <span class="n">auid</span><span class="o">!=-</span><span class="mi">1</span> <span class="o">-</span><span class="n">k</span> <span class="n">perm_mod</span>
<span class="o">-</span><span class="n">a</span> <span class="n">always</span><span class="p">,</span><span class="n">exit</span> <span class="o">-</span><span class="n">F</span> <span class="n">arch</span><span class="o">=</span><span class="n">b64</span> <span class="o">-</span><span class="n">S</span> <span class="n">fchown</span> <span class="o">-</span><span class="n">F</span> <span class="n">auid</span><span class="o">&gt;=</span><span class="mi">1000</span> <span class="o">-</span><span class="n">F</span> <span class="n">auid</span><span class="o">!=-</span><span class="mi">1</span> <span class="o">-</span><span class="n">k</span> <span class="n">perm_mod</span>
<span class="o">-</span><span class="n">a</span> <span class="n">always</span><span class="p">,</span><span class="n">exit</span> <span class="o">-</span><span class="n">F</span> <span class="n">arch</span><span class="o">=</span><span class="n">b64</span> <span class="o">-</span><span class="n">S</span> <span class="n">fchownat</span> <span class="o">-</span><span class="n">F</span> <span class="n">auid</span><span class="o">&gt;=</span><span class="mi">1000</span> <span class="o">-</span><span class="n">F</span> <span class="n">auid</span><span class="o">!=-</span><span class="mi">1</span> <span class="o">-</span><span class="n">k</span> <span class="n">perm_mod</span>
<span class="o">-</span><span class="n">a</span> <span class="n">always</span><span class="p">,</span><span class="n">exit</span> <span class="o">-</span><span class="n">F</span> <span class="n">arch</span><span class="o">=</span><span class="n">b64</span> <span class="o">-</span><span class="n">S</span> <span class="n">fremovexattr</span> <span class="o">-</span><span class="n">F</span> <span class="n">auid</span><span class="o">&gt;=</span><span class="mi">1000</span> <span class="o">-</span><span class="n">F</span> <span class="n">auid</span><span class="o">!=-</span><span class="mi">1</span> <span class="o">-</span><span class="n">k</span> <span class="n">perm_mod</span>
<span class="o">-</span><span class="n">a</span> <span class="n">always</span><span class="p">,</span><span class="n">exit</span> <span class="o">-</span><span class="n">F</span> <span class="n">arch</span><span class="o">=</span><span class="n">b64</span> <span class="o">-</span><span class="n">S</span> <span class="n">fsetxattr</span> <span class="o">-</span><span class="n">F</span> <span class="n">auid</span><span class="o">&gt;=</span><span class="mi">1000</span> <span class="o">-</span><span class="n">F</span> <span class="n">auid</span><span class="o">!=-</span><span class="mi">1</span> <span class="o">-</span><span class="n">k</span> <span class="n">perm_mod</span>
<span class="o">-</span><span class="n">a</span> <span class="n">always</span><span class="p">,</span><span class="n">exit</span> <span class="o">-</span><span class="n">F</span> <span class="n">arch</span><span class="o">=</span><span class="n">b64</span> <span class="o">-</span><span class="n">S</span> <span class="n">lchown</span> <span class="o">-</span><span class="n">F</span> <span class="n">auid</span><span class="o">&gt;=</span><span class="mi">1000</span> <span class="o">-</span><span class="n">F</span> <span class="n">auid</span><span class="o">!=-</span><span class="mi">1</span> <span class="o">-</span><span class="n">k</span> <span class="n">perm_mod</span>
<span class="o">-</span><span class="n">a</span> <span class="n">always</span><span class="p">,</span><span class="n">exit</span> <span class="o">-</span><span class="n">F</span> <span class="n">arch</span><span class="o">=</span><span class="n">b64</span> <span class="o">-</span><span class="n">S</span> <span class="n">lremovexattr</span> <span class="o">-</span><span class="n">F</span> <span class="n">auid</span><span class="o">&gt;=</span><span class="mi">1000</span> <span class="o">-</span><span class="n">F</span> <span class="n">auid</span><span class="o">!=-</span><span class="mi">1</span> <span class="o">-</span><span class="n">k</span> <span class="n">perm_mod</span>
<span class="o">-</span><span class="n">a</span> <span class="n">always</span><span class="p">,</span><span class="n">exit</span> <span class="o">-</span><span class="n">F</span> <span class="n">arch</span><span class="o">=</span><span class="n">b64</span> <span class="o">-</span><span class="n">S</span> <span class="n">lsetxattr</span> <span class="o">-</span><span class="n">F</span> <span class="n">auid</span><span class="o">&gt;=</span><span class="mi">1000</span> <span class="o">-</span><span class="n">F</span> <span class="n">auid</span><span class="o">!=-</span><span class="mi">1</span> <span class="o">-</span><span class="n">k</span> <span class="n">perm_mod</span>
<span class="o">-</span><span class="n">a</span> <span class="n">always</span><span class="p">,</span><span class="n">exit</span> <span class="o">-</span><span class="n">F</span> <span class="n">arch</span><span class="o">=</span><span class="n">b64</span> <span class="o">-</span><span class="n">S</span> <span class="n">removexattr</span> <span class="o">-</span><span class="n">F</span> <span class="n">auid</span><span class="o">&gt;=</span><span class="mi">1000</span> <span class="o">-</span><span class="n">F</span> <span class="n">auid</span><span class="o">!=-</span><span class="mi">1</span> <span class="o">-</span><span class="n">k</span> <span class="n">perm_mod</span>
<span class="o">-</span><span class="n">a</span> <span class="n">always</span><span class="p">,</span><span class="n">exit</span> <span class="o">-</span><span class="n">F</span> <span class="n">arch</span><span class="o">=</span><span class="n">b64</span> <span class="o">-</span><span class="n">S</span> <span class="n">setxattr</span> <span class="o">-</span><span class="n">F</span> <span class="n">auid</span><span class="o">&gt;=</span><span class="mi">1000</span> <span class="o">-</span><span class="n">F</span> <span class="n">auid</span><span class="o">!=-</span><span class="mi">1</span> <span class="o">-</span><span class="n">k</span> <span class="n">perm_mod</span>

<span class="c1">################################### SOME SPECIFIC RULES ##################################</span>
<span class="c1">## Privilege Abuse</span>
<span class="c1">#### The purpose of this rule is to detect when an admin may be abusing power by looking in user&#39;s home dir.</span>
<span class="o">-</span><span class="n">a</span> <span class="n">always</span><span class="p">,</span><span class="n">exit</span> <span class="o">-</span><span class="n">F</span> <span class="nb">dir</span><span class="o">=/</span><span class="n">home</span> <span class="o">-</span><span class="n">F</span> <span class="n">uid</span><span class="o">=</span><span class="mi">0</span> <span class="o">-</span><span class="n">F</span> <span class="n">auid</span><span class="o">&gt;=</span><span class="mi">1000</span> <span class="o">-</span><span class="n">F</span> <span class="n">auid</span><span class="o">!=-</span><span class="mi">1</span> <span class="o">-</span><span class="n">C</span> <span class="n">auid</span><span class="o">!=</span><span class="n">obj_uid</span> <span class="o">-</span><span class="n">k</span> <span class="n">power_abuse</span>

<span class="c1"># DPKG / APT-GET (Debian/Ubuntu)</span>
<span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">dpkg</span> <span class="o">-</span><span class="n">p</span> <span class="n">x</span> <span class="o">-</span><span class="n">k</span> <span class="n">software_mgmt</span>
<span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">apt</span> <span class="o">-</span><span class="n">p</span> <span class="n">x</span> <span class="o">-</span><span class="n">k</span> <span class="n">software_mgmt</span>
<span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">apt</span><span class="o">-</span><span class="n">add</span><span class="o">-</span><span class="n">repository</span> <span class="o">-</span><span class="n">p</span> <span class="n">x</span> <span class="o">-</span><span class="n">k</span> <span class="n">software_mgmt</span>
<span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="o">-</span><span class="n">p</span> <span class="n">x</span> <span class="o">-</span><span class="n">k</span> <span class="n">software_mgmt</span>
<span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">aptitude</span> <span class="o">-</span><span class="n">p</span> <span class="n">x</span> <span class="o">-</span><span class="n">k</span> <span class="n">software_mgmt</span>
<span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">wajig</span> <span class="o">-</span><span class="n">p</span> <span class="n">x</span> <span class="o">-</span><span class="n">k</span> <span class="n">software_mgmt</span>
<span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">snap</span> <span class="o">-</span><span class="n">p</span> <span class="n">x</span> <span class="o">-</span><span class="n">k</span> <span class="n">software_mgmt</span>

<span class="c1">## Injection</span>
<span class="c1">#### These rules watch for code injection by the ptrace facility.</span>
<span class="c1">#### This could indicate someone trying to do something bad or just debugging</span>
<span class="o">-</span><span class="n">a</span> <span class="n">always</span><span class="p">,</span><span class="n">exit</span> <span class="o">-</span><span class="n">F</span> <span class="n">arch</span><span class="o">=</span><span class="n">b32</span> <span class="o">-</span><span class="n">S</span> <span class="n">ptrace</span> <span class="o">-</span><span class="n">F</span> <span class="n">a0</span><span class="o">=</span><span class="mh">0x4</span> <span class="o">-</span><span class="n">k</span> <span class="n">code_injection</span>
<span class="o">-</span><span class="n">a</span> <span class="n">always</span><span class="p">,</span><span class="n">exit</span> <span class="o">-</span><span class="n">F</span> <span class="n">arch</span><span class="o">=</span><span class="n">b64</span> <span class="o">-</span><span class="n">S</span> <span class="n">ptrace</span> <span class="o">-</span><span class="n">F</span> <span class="n">a0</span><span class="o">=</span><span class="mh">0x4</span> <span class="o">-</span><span class="n">k</span> <span class="n">code_injection</span>
<span class="o">-</span><span class="n">a</span> <span class="n">always</span><span class="p">,</span><span class="n">exit</span> <span class="o">-</span><span class="n">F</span> <span class="n">arch</span><span class="o">=</span><span class="n">b32</span> <span class="o">-</span><span class="n">S</span> <span class="n">ptrace</span> <span class="o">-</span><span class="n">F</span> <span class="n">a0</span><span class="o">=</span><span class="mh">0x5</span> <span class="o">-</span><span class="n">k</span> <span class="n">data_injection</span>
<span class="o">-</span><span class="n">a</span> <span class="n">always</span><span class="p">,</span><span class="n">exit</span> <span class="o">-</span><span class="n">F</span> <span class="n">arch</span><span class="o">=</span><span class="n">b64</span> <span class="o">-</span><span class="n">S</span> <span class="n">ptrace</span> <span class="o">-</span><span class="n">F</span> <span class="n">a0</span><span class="o">=</span><span class="mh">0x5</span> <span class="o">-</span><span class="n">k</span> <span class="n">data_injection</span>
<span class="o">-</span><span class="n">a</span> <span class="n">always</span><span class="p">,</span><span class="n">exit</span> <span class="o">-</span><span class="n">F</span> <span class="n">arch</span><span class="o">=</span><span class="n">b32</span> <span class="o">-</span><span class="n">S</span> <span class="n">ptrace</span> <span class="o">-</span><span class="n">F</span> <span class="n">a0</span><span class="o">=</span><span class="mh">0x6</span> <span class="o">-</span><span class="n">k</span> <span class="n">register_injection</span>
<span class="o">-</span><span class="n">a</span> <span class="n">always</span><span class="p">,</span><span class="n">exit</span> <span class="o">-</span><span class="n">F</span> <span class="n">arch</span><span class="o">=</span><span class="n">b64</span> <span class="o">-</span><span class="n">S</span> <span class="n">ptrace</span> <span class="o">-</span><span class="n">F</span> <span class="n">a0</span><span class="o">=</span><span class="mh">0x6</span> <span class="o">-</span><span class="n">k</span> <span class="n">register_injection</span>
<span class="o">-</span><span class="n">a</span> <span class="n">always</span><span class="p">,</span><span class="n">exit</span> <span class="o">-</span><span class="n">F</span> <span class="n">arch</span><span class="o">=</span><span class="n">b32</span> <span class="o">-</span><span class="n">S</span> <span class="n">ptrace</span> <span class="o">-</span><span class="n">k</span> <span class="n">tracing</span>
<span class="o">-</span><span class="n">a</span> <span class="n">always</span><span class="p">,</span><span class="n">exit</span> <span class="o">-</span><span class="n">F</span> <span class="n">arch</span><span class="o">=</span><span class="n">b64</span> <span class="o">-</span><span class="n">S</span> <span class="n">ptrace</span> <span class="o">-</span><span class="n">k</span> <span class="n">tracing</span>

<span class="c1">## Suspicious activity</span>
<span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">wget</span> <span class="o">-</span><span class="n">p</span> <span class="n">x</span> <span class="o">-</span><span class="n">k</span> <span class="n">susp_activity</span>
<span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">curl</span> <span class="o">-</span><span class="n">p</span> <span class="n">x</span> <span class="o">-</span><span class="n">k</span> <span class="n">susp_activity</span>
<span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">base64</span> <span class="o">-</span><span class="n">p</span> <span class="n">x</span> <span class="o">-</span><span class="n">k</span> <span class="n">susp_activity</span>
<span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">nc</span> <span class="o">-</span><span class="n">p</span> <span class="n">x</span> <span class="o">-</span><span class="n">k</span> <span class="n">susp_activity</span>
<span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">netcat</span> <span class="o">-</span><span class="n">p</span> <span class="n">x</span> <span class="o">-</span><span class="n">k</span> <span class="n">susp_activity</span>
<span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">ncat</span> <span class="o">-</span><span class="n">p</span> <span class="n">x</span> <span class="o">-</span><span class="n">k</span> <span class="n">susp_activity</span>
<span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">ssh</span> <span class="o">-</span><span class="n">p</span> <span class="n">x</span> <span class="o">-</span><span class="n">k</span> <span class="n">susp_activity</span>
<span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">scp</span> <span class="o">-</span><span class="n">p</span> <span class="n">x</span> <span class="o">-</span><span class="n">k</span> <span class="n">susp_activity</span>
<span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">sftp</span> <span class="o">-</span><span class="n">p</span> <span class="n">x</span> <span class="o">-</span><span class="n">k</span> <span class="n">susp_activity</span>
<span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">ftp</span> <span class="o">-</span><span class="n">p</span> <span class="n">x</span> <span class="o">-</span><span class="n">k</span> <span class="n">susp_activity</span>
<span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">socat</span> <span class="o">-</span><span class="n">p</span> <span class="n">x</span> <span class="o">-</span><span class="n">k</span> <span class="n">susp_activity</span>
<span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">wireshark</span> <span class="o">-</span><span class="n">p</span> <span class="n">x</span> <span class="o">-</span><span class="n">k</span> <span class="n">susp_activity</span>
<span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">tshark</span> <span class="o">-</span><span class="n">p</span> <span class="n">x</span> <span class="o">-</span><span class="n">k</span> <span class="n">susp_activity</span>
<span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">rawshark</span> <span class="o">-</span><span class="n">p</span> <span class="n">x</span> <span class="o">-</span><span class="n">k</span> <span class="n">susp_activity</span>
<span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">rdesktop</span> <span class="o">-</span><span class="n">p</span> <span class="n">x</span> <span class="o">-</span><span class="n">k</span> <span class="n">susp_activity</span>
<span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">nmap</span> <span class="o">-</span><span class="n">p</span> <span class="n">x</span> <span class="o">-</span><span class="n">k</span> <span class="n">susp_activity</span>
</pre></div>
</div>
<p>Vérifions que auditd fonctionne et joue son rôle. On appelle la commande base64, qui est surveillée car elle peut être utilisée pour de l’extraction de données :</p>
<p><img alt="../_images/3_testing_suspicious_call.PNG" src="../_images/3_testing_suspicious_call.PNG" /></p>
<p>On remarque alors dans les logs d’auditd que l’action a bien été tracée :</p>
<p><img alt="../_images/4_show_appears_in_logs.PNG" src="../_images/4_show_appears_in_logs.PNG" /></p>
</div>
<div class="section" id="commentaires">
<h2>Commentaires<a class="headerlink" href="#commentaires" title="Permalink to this headline">¶</a></h2>
<p>Ici, le choix a été fait de ne surveiller que les éléments qui nous semblaient essentiels <strong>pour notre utilisation</strong>. Il faut bien noter que ce fichier est à adapter en fonction des besoins.</p>
<p>/!\ Il faut porter une attention particulière à la charge que peut apporter chacune des règles. En effet, on pourrait faire le choix, par exemple, de logguer toutes les commandes exécutées sous l’utilisateur root. Cependant, de trop nombreux logs seraient générés, et il deviendrait alors difficile d’exploiter tous les logs (notamment vis-à-vis des ressources de la machine).</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="apparmor.html" class="btn btn-neutral float-right" title="Mise en place de AppArmor" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="rsyslog.html" class="btn btn-neutral float-left" title="Rsyslog" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Bastien SECHER - Olivier CUREAU - Mael FANJOUX.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>